!function(){"use strict";const t=window?.bit_assist_?.api?.base,i="1"!==window?.bit_assist_?.isDev,e=i?`${t}/iframe`:"http://localhost:5000",o=new URL(e).origin,n=i&&window?.bit_assist_?.api?.separator||"?",{protocol:s,host:a,hostname:d,href:r}=window.location,c="http:"===s?"i":"s",w="localhost"===d||"127.0.0.1"===d?a:d,l=r;let h="100px",p="100px",u=0;const f=`\n#bit-assist-widget-container{--ba-top:auto;--ba-left:auto;--ba-bottom:10;--ba-right:10;position:fixed;z-index:2147483646;bottom:0;right:0;width:${p};height:${h};max-width:100%}\n#bit-assist-widget-container.bottom-right{left:var(--ba-left);right:var(--ba-right);top:var(--ba-top);bottom:var(--ba-bottom)}\n#bit-assist-widget-container.bottom-left{left:var(--ba-left);right:var(--ba-right);top:var(--ba-top);bottom:var(--ba-bottom)}\n#bit-assist-widget-container.top-right{left:var(--ba-left);right:var(--ba-right);top:var(--ba-top);bottom:var(--ba-bottom)}\n#bit-assist-widget-container.top-left{left:var(--ba-left);right:var(--ba-right);top:var(--ba-top);bottom:var(--ba-bottom)}\n#bit-assist-widget-iframe{width:100%;height:100%;border:none;}\n.bit-assist-hide{visibility:hidden;pointer-events:none}\n`,b=document.createElement("style");b.appendChild(document.createTextNode(f));const g=document.createElement("div");g.id="bit-assist-widget-container",M();const m=document.createElement("iframe");function v(t,i=!1){const e=window.scrollY,o=document.body.offsetHeight,n=window.innerHeight,s=Math.round(e/(o-n)*100);if(!i)return s;!u&&s>=i?(u=1,y(s)):u&&s<i&&(u=0,y(s))}function y(t){m.contentWindow.postMessage({action:"scrollPercent",scrollPercent:t},o)}function A(t,i){p=`${t}px`,h=`${i}px`,Object.assign(g.style,{width:p,height:h})}m.title="wp-bit-assist",m.src=`${e}${n}clientDomain=${c}-protocol-bit-assist-${w}`,m.id="bit-assist-widget-iframe",m.setAttribute("allowfullscreen",""),m.setAttribute("scrolling","no"),g.appendChild(m),document.body.append(b,g),document.addEventListener("click",t=>{g.classList.contains("bit-assist-open")&&!t.target.closest("#bit-assist-widget-container")&&m.contentWindow.postMessage({action:"clickOutside"},o)}),window.addEventListener("message",i=>{if(i.origin!==o)return;const{action:e}=i.data;if("getClientInfo"===e){const i=v(),e=document.documentElement.offsetWidth,n=window.innerHeight;m.contentWindow.postMessage({action:"windowLoaded",url:l,winWidth:e,winHeight:n,scrollPercent:i,apiEndPoint:t},o)}else if("widgetLoaded"===e){const{height:t,width:e,position:o,top:n,bottom:s,left:a,right:d,pageScroll:r}=i.data;!function(t,i,e,o,n){t.includes("top")&&g.style.setProperty("--ba-top",`${i}px`);t.includes("bottom")&&g.style.setProperty("--ba-bottom",`${e}px`);t.includes("left")&&g.style.setProperty("--ba-left",`${o}px`);t.includes("right")&&g.style.setProperty("--ba-right",`${n}px`)}(o,n,s,a,d),g.classList.remove("bit-assist-hide"),g.classList.add(o),A(e,t),r>0&&window.addEventListener("scroll",t=>v(0,r))}else if("widgetOpen"===e){P()&&!0===Boolean(window.Tawk_API?.isChatMaximized?.())&&window.Tawk_API?.minimize();const{isWidgetOpen:t}=i.data;g.classList.toggle("bit-assist-open",t)}else if("removeWidget"===e)g.remove(),b.remove();else if("resetWidgetSize"===e){const{height:t,width:e}=i.data;A(e,t)}else if("chatWidgetClick"===e){const{chatWidgetName:t}=i.data;!function(t){z(),"tawk"===t&&function(){if(!C)return H("Tawk"),null;try{window.Tawk_API.showWidget(),window.Tawk_API.toggle(),M()}catch(t){console.log(t),H("Tawk"),E()}}();"crisp"===t&&function(){if(!I)return H("Crisp"),null;try{window.$crisp.push(["do","chat:show"]),window.$crisp.push(["do","chat:toggle"]),M()}catch{H("Crisp"),E()}}();"intercom"===t&&function(){if(!L)return H("Intercom"),null;try{window.Intercom("show"),M()}catch(t){console.log(t),H("Intercom"),E()}}();"tidio"===t&&function(){if(!$)return H("Tidio"),null;try{window.tidioChatApi.open(),window.tidioChatApi.show(),M()}catch(t){console.log(t),H("Tidio"),E()}}()}(t)}else if("bitAssistChannelClick"===e){const{channelInfo:t}=i.data;window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"bitAssistChannel",...t})}}),window.addEventListener("load",()=>{P()&&(window.Tawk_API.onLoad=function(){C=!0,window.Tawk_API.hideWidget()},window.Tawk_API.onChatMinimized=function(){window.Tawk_API.hideWidget(),E()}),_()&&(I=!0,window.$crisp.push(["do","chat:hide"]),window.$crisp.push(["on","chat:closed",function(){window.$crisp.push(["do","chat:hide"]),E()}])),k()&&(L=!0,window.Intercom("update",{hide_default_launcher:!0}),window.Intercom("onShow",()=>{M()}),window.Intercom("onHide",()=>{E()})),W()?(window.tidioChatApi.on("ready",T),window.tidioChatApi.on("close",x)):(document.addEventListener("tidioChat-ready",T),document.addEventListener("tidioChat-close",x))});let C=!1,$=!1,I=!1,L=!1;function P(){return"undefined"!=typeof Tawk_API}function _(){return"undefined"!=typeof $crisp}function k(){return"undefined"!=typeof Intercom}function T(){$=!0,window.tidioChatApi.hide()}function x(){E(),window.tidioChatApi.hide()}function W(){return"undefined"!=typeof tidioChatApi}function E(){g.classList.remove("bit-assist-hide"),z()}function z(){P()&&window.Tawk_API?.minimize?.(),_()&&window.$crisp?.push?.(["do","chat:hide"]),k()&&window.Intercom?.("hide"),W()&&window.tidioChatApi?.hide?.()}function M(){g.classList.add("bit-assist-hide")}function H(t){return alert(`Sorry, ${t} is not loaded yet!`)}}();
