"use strict";var mt=Object.defineProperty;var lt=Object.getOwnPropertySymbols;var gt=Object.prototype.hasOwnProperty,ft=Object.prototype.propertyIsEnumerable;var Q=(i,t,e)=>t in i?mt(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,F=(i,t)=>{for(var e in t||(t={}))gt.call(t,e)&&Q(i,e,t[e]);if(lt)for(var e of lt(t))ft.call(t,e)&&Q(i,e,t[e]);return i};var h=(i,t,e)=>(Q(i,typeof t!="symbol"?t+"":t,e),e),dt=(i,t,e)=>{if(!t.has(i))throw TypeError("Cannot "+e)};var T=(i,t,e)=>(dt(i,t,"read from private field"),e?e.call(i):t.get(i)),U=(i,t,e)=>{if(t.has(i))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(i):t.set(i,e)},$=(i,t,e,s)=>(dt(i,t,"write to private field"),s?s.call(i,e):t.set(i,e),e);var x=(i,t,e)=>new Promise((s,o)=>{var n=d=>{try{a(e.next(d))}catch(u){o(u)}},r=d=>{try{a(e.throw(d))}catch(u){o(u)}},a=d=>d.done?s(d.value):Promise.resolve(d.value).then(n,r);a((e=e.apply(i,t)).next())});const G=""+(typeof document>"u"?new(require("url")).URL("file:"+__dirname+"/close-icon.16a4dff2.svg").href:new URL("close-icon.16a4dff2.svg",document.currentScript&&document.currentScript.tagName.toUpperCase()==="SCRIPT"&&document.currentScript.src||document.baseURI).href),ht=""+(typeof document>"u"?new(require("url")).URL("file:"+__dirname+"/right-circle-arrow.395e19da.svg").href:new URL("right-circle-arrow.395e19da.svg",document.currentScript&&document.currentScript.tagName.toUpperCase()==="SCRIPT"&&document.currentScript.src||document.baseURI).href),p=i=>document.querySelector(i);function c(i,t){const e=document.createElement(i);if(t)for(const s in t)e.setAttribute(s,t[s]);return e}const l=(i,t)=>Array.isArray(t)?i.append(...t):i.append(t),y=(i,t,e)=>i.addEventListener(t,e),_=(i,t,e)=>i.setProperty(t,e),H=(i,t,e)=>i.postMessage(t,e),z=(i,t)=>i.querySelectorAll(t),S=(i,t)=>i==null?void 0:i.classList.remove(t),b=(i,t)=>i==null?void 0:i.classList.add(t),I=(i,t)=>i==null?void 0:i.classList.contains(t),q=(i,t)=>i==null?void 0:i.classList.toggle(t);function W(i,t,e){i.setAttribute(t,e)}function v(i,t){i.innerHTML=t}function w(i,t){i.textContent=t}const yt={hideChannels(){I(this.channels,"show")&&S(this.channels,"show")},debounce(i,t){let e;return function(...s){const o=this;clearTimeout(e),e=setTimeout(()=>i.apply(o,s),t)}},renderCard(){if(p("#card")){b(this.card,"show");return}this.card=c("div",{id:"card",class:"show"});const i=c("div",{id:"cardHeader"}),t=c("h4"),e=c("button",{class:"iconBtn closeCardBtn",title:"Close"}),s=c("img",{src:G,alt:"Close"});l(e,s),l(i,[t,e]),this.cardBody=c("div",{id:"cardBody"}),l(this.card,[i,this.cardBody]),l(this.contentWrapper,this.card),y(e,"click",this.closeWidget)},setCardStyle(i){var t,e,s,o;this.selectedFormBg=(e=(t=i==null?void 0:i.card_config)==null?void 0:t.card_bg_color)==null?void 0:e.str,v(p("#cardHeader>h4"),i==null?void 0:i.title),_(this.root.style,"--card-theme-color",this.selectedFormBg),_(this.root.style,"--card-text-color",(o=(s=i==null?void 0:i.card_config)==null?void 0:s.card_text_color)==null?void 0:o.str)},hideCard(){I(this.card,"show")&&S(this.card,"show")},itemListAppend(i){const t=[];i==null||i.forEach(e=>{const s=c("div",{class:"listItem"}),o=c("button",{class:"listItemTitleWrapper","data-item_id":e.id?e.id:e.order_id}),n=c("p",{class:"title"});v(n,e.title?e.title:(e.order_id?`Order Id: ${e.order_id} (${e.shipping_status})`:"")||"");const r=c("img",{src:ht,alt:"Details"});l(o,r),l(o,n),l(s,o),t.push(s)}),l(p("#lists"),t)},searchList(i){const t=i.target.value.toLowerCase();z(document,".listItem").forEach(e=>{e.querySelector(".title").textContent.toLowerCase().includes(t)?S(e,"hide"):b(e,"hide")})},resetClientWidgetSize(){H(parent,{action:"resetWidgetSize",height:this.widgetWrapper.offsetHeight,width:this.widgetWrapper.offsetWidth},`${this.clientDomain}`)}},P={renderForm(i){var r;const t=this;t.hideChannels(),t.renderCard(),t.setCardStyle(i.config);const e=(r=i.config)==null?void 0:r.card_config;t.formBody=c("form",{id:"formBody",method:"POST"});const s=c("div",{id:"dynamicFields"}),o=c("input",{type:"hidden",name:"widget_channel_id",value:i.id}),n=c("button",{type:"submit"});w(n,e==null?void 0:e.submit_button_text),l(t.formBody,[s,o,n]),v(t.cardBody,""),l(t.cardBody,t.formBody),y(t.formBody,"submit",a=>P.formSubmitted(t,a)),P.createAllFields(e==null?void 0:e.form_fields)},createAllFields(i){const t=p("#dynamicFields");let e=!1;i==null||i.forEach(s=>{s.field_type==="file"&&!e&&(W(p("#formBody"),"enctype","multipart/form-data"),e=!0),s.field_type==="rating"?P.createRatingField(s,t,"rating"):s.field_type==="feedback"?P.createRatingField(s,t,"feedback"):P.createTextField(s,t)})},createRatingField(i,t,e){const s=Math.floor(Math.random()*1e8),o=i.label.toLowerCase().replace(/ /g,"_"),n=c("div",{class:e});e==="rating"&&b(n,i.rating_type);let r=[];e==="feedback"?r=["bug","suggest","love"]:i.rating_type==="star"?r=["5 star","4 star","3 star","2 star","1 star"]:r=["sad","confused","happy"],r.forEach(a=>{const d=`${o}_${a.replace(/ /g,"_")}_${s}`,u=c("input",{type:"radio",name:o,value:a,id:d});i.required&&W(u,"required","");const m=c("label",{title:a,for:d,class:a});if(e==="feedback"){v(m,`${a.charAt(0).toUpperCase()+a.slice(1)}`);const g=c("div",{class:"feedback-icon"});m.prepend(g)}l(n,[u,m])}),l(t,n)},createTextField(i,t){const e=c(i.field_type==="textarea"?"textarea":"input");if(W(e,"name",`${i.label.toLowerCase().replace(/ /g,"_")}${i!=null&&i.allow_multiple?"[]":""}`),W(e,"placeholder",i.label+(i.required?"":" (optional)")),i.required&&W(e,"required",""),i.field_type==="GDPR"){P.gdprField(i,t,e);return}if(b(e,"formControl"),W(e,"type",i.field_type),i.field_type==="file"){P.fileField(i,t,e);return}l(t,e)},fileField(i,t,e){i!=null&&i.allow_multiple&&W(e,"multiple","");const s=c("div",{class:"formControl customFile"}),o=c("div",{class:"cfit"}),n=c("button",{class:"cfit-btn",type:"button"});w(n,"Attach File");const r=c("div",{class:"cfit-title"});w(r,"No file chosen"),l(o,[n,r]),l(s,[o,e]),l(t,s),y(n,"click",()=>e.click()),y(e,"change",a=>{let d="No file chosen";const u=a.target.files.length;u>0&&(d=u===1?a.target.files[0].name:`${u} files`),w(r,d)})},gdprField(i,t,e){W(e,"type","checkbox");const s=c("a",{target:"_blank"});v(s,i.label),i!=null&&i.url&&(s.href=i.url);const o=c("div",{class:"gdprContainer"});l(o,[e,s]),l(t,o)},formSubmitted(i,t){return x(this,null,function*(){t.preventDefault();const e=t.target.querySelector('[type="submit"]'),s=e.textContent,o=new FormData(t.target);try{w(e,"Sending..."),b(e,"disabled");const n=yield fetch(`${i.apiEndPoint}/responses`,{method:"POST",body:o}).then(r=>r.json());(n==null?void 0:n.status)==="success"?yield P.showToast(i,"success",n==null?void 0:n.data):yield P.showToast(i,"error",n==null?void 0:n.data),t.target.reset(),z(t.target,".cfit-title").forEach(r=>{w(r,"No file chosen")}),S(e,"disabled"),w(e,s)}catch(n){console.log(n),yield P.showToast(i,"error"),t.target.reset(),z(t.target,".cfit-title").forEach(r=>{w(r,"No file chosen")}),S(e,"disabled"),w(e,s)}})},showToast(i,t,e){return x(this,null,function*(){if(!i.cardBody.contains(i.formBody))return;const s=c("div",{class:`toast ${t}`}),o=c("div",{class:"toast-content"}),n=c("div",{class:"toast-text"}),r=c("div",{class:"toast-text-title"});r.textContent=t==="success"?"Success":"Error";const a=c("div",{class:"toast-text-body"});a.textContent=t==="success"?e:"Something went wrong",l(n,[r,a]),l(o,n),l(s,o),l(i.cardBody,s),b(i.formBody,"hide"),I(s,"success")&&(r.style.color=i.selectedFormBg),yield i.delay(10),I(i.formBody,"hide")&&(i.cardBody.removeChild(s),S(i.formBody,"hide"))})}},wt={renderIframe(i,t,e=!1,s=!1){if(this.hideChannels(),this.iFrameWrapper=c("div",{id:"iframe-wrapper",class:t.toLowerCase()}),e)v(this.iFrameWrapper,e);else{const o=c("iframe",{scrolling:(s==null?void 0:s.scrollbar)===!0?"yes":"no",src:i,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""});l(this.iFrameWrapper,o)}if(s){const{aspect_ratio:o,width:n,height:r}=s;o==="custom"&&(_(this.root.style,"--iframe-height",`${n}px`),_(this.root.style,"--iframe-height",`${r}px`)),_(this.root.style,"--iframe-aspect-ratio",o)}l(p("#contentWrapper"),this.iFrameWrapper),this.resetClientWidgetSize()},removeIframe(){this.iFrameWrapper.remove(),this.iFrameWrapper=void 0,this.resetClientWidgetSize()}},tt=""+(typeof document>"u"?new(require("url")).URL("file:"+__dirname+"/left-circle-arrow.39b1d855.svg").href:new URL("left-circle-arrow.39b1d855.svg",document.currentScript&&document.currentScript.tagName.toUpperCase()==="SCRIPT"&&document.currentScript.src||document.baseURI).href),V={renderFaq(i){var B;const t=this;t.hideChannels(),t.renderCard(),t.setCardStyle(i.config);const e=(B=i.config)==null?void 0:B.card_config,s=c("div",{id:"faqBody"}),o=c("div",{id:"listWrapper"}),n=c("div",{id:"lists"}),r=c("input",{type:"text",id:"listSearch",class:"formControl",placeholder:"Search"});l(o,[n,r]);const a=c("div",{id:"faqDescription"}),d=c("div",{class:"descriptionTitle"}),u=c("button",{class:"iconBtn closeDescBtn",title:"Back"}),m=c("img",{src:tt,alt:"back"});l(u,m);const g=c("p");l(d,[u,g]);const f=c("div",{class:"content"});l(a,[d,f]),l(s,[o,a]),v(t.cardBody,""),l(t.cardBody,s),y(r,"input",t.searchList),y(u,"click",C=>V.faqDescToggle(t,C)),V.renderFaqItem(t,e==null?void 0:e.faqs)},renderFaqItem(i,t){i.itemListAppend(t),z(document,".listItemTitleWrapper").forEach(e=>{y(e,"click",s=>V.faqDescToggle(i,s,t))})},faqDescToggle(i,t,e){if(e){const n=e.find(r=>Number(r.id)===Number(t.target.closest(".listItemTitleWrapper").dataset.item_id));v(p(".descriptionTitle p"),(n==null?void 0:n.title)||""),v(p(".content"),(n==null?void 0:n.description)||"")}const s=p("#faqBody");if(q(p("#faqBody"),"openDesc")){const n=p("#faqDescription").scrollHeight;Object.assign(s.style,{height:n>400?"400px":`${n}px`,overflow:n>400?"auto":"initial"})}else s.removeAttribute("style");q(p("#listWrapper"),"hide"),i.resetClientWidgetSize()}},Y={renderKnowledgeBase(i){var R;const t=this;t.hideChannels(),t.renderCard(),t.setCardStyle(i.config);const e=(R=i.config)==null?void 0:R.card_config,s=c("div",{id:"knowledgeBaseBody"}),o=c("div",{id:"listWrapper"}),n=c("div",{id:"lists"}),r=c("input",{type:"text",id:"listSearch",class:"formControl",placeholder:"Search"});l(o,[n,r]);const a=c("div",{class:"overlay"}),d=c("div",{id:"knowledgeBaseDescription"}),u=c("div",{class:"descriptionTitle"}),m=c("p"),g=c("div",{class:"modalActions"}),f=c("button",{class:"iconBtn rounded prevKB",title:"Prev"}),B=c("img",{src:tt,alt:"prev"});l(f,B);const C=c("button",{class:"iconBtn rounded nextKB",title:"Next"}),k=c("img",{src:ht,alt:"next"});l(C,k);const A=c("button",{class:"iconBtn rounded closeKB",title:"Close"}),O=c("img",{src:G,alt:"close"});l(A,O),l(g,[f,C,A]),l(u,[m,g]);const L=c("div",{class:"content"});l(d,[u,L]),l(s,[o,a,d]),v(t.cardBody,""),l(t.cardBody,s),y(r,"input",t.searchList),y(A,"click",()=>Y.knowledgeBaseDescToggle(t)),y(f,"click",()=>t.gotoPrevNextKB("previousElementSibling")),y(C,"click",()=>t.gotoPrevNextKB("nextElementSibling")),t.renderKnowledgeBaseItem(t,e==null?void 0:e.knowledge_bases)},renderKnowledgeBaseItem(i,t){i.itemListAppend(t),z(document,".listItemTitleWrapper").forEach(e=>{y(e,"click",s=>Y.knowledgeBaseDescToggle(i,s,t))})},gotoPrevNextKB(i){const t=p(".listItem.active")[i];t&&t.querySelector(".listItemTitleWrapper").click()},knowledgeBaseDescToggle(i,t,e){S(p(".listItem.active"),"active");const s=p("#knowledgeBaseBody");if(!e){S(s,"openDesc"),_(i.root.style,"--card-width","330px"),i.resetClientWidgetSize();return}q(t.target.closest(".listItem"),"active");const o=e.find(n=>Number(n.id)===Number(t.target.closest(".listItemTitleWrapper").dataset.item_id));!o||(b(s,"openDesc"),v(p(".descriptionTitle p"),(o==null?void 0:o.title)||""),v(p(".content"),(o==null?void 0:o.description)||""),_(i.root.style,"--modal-title-height",`${p(".descriptionTitle").offsetHeight}px`),_(i.root.style,"--card-width","767px"),i.resetClientWidgetSize())}},bt={renderWeChat(i){const t=this;t.hideChannels(),t.renderCard(),t.setCardStyle(i.config);const{url:e}=i.config,s=c("div",{id:"weChatBody",style:"min-height: calc(var(--card-width) - 30px)"}),o=c("img",{id:"weChatQRCode",alt:"WeChat QR Code",src:e,style:"width: 100%"});l(s,o),v(t.cardBody,""),l(t.cardBody,s)}},D={renderWooCommerce(i){var r;const t=this;t.hideChannels(),t.renderCard(),t.setCardStyle(i.config);const e=(r=i.config)==null?void 0:r.card_config;t.formBody=c("form",{id:"formBody",method:"POST"});const s=c("div",{id:"dynamicFields"}),o=c("input",{type:"hidden",name:"widget_channel_id",value:i.id}),n=c("button",{type:"submit"});w(n,e==null?void 0:e.submit_button_text),l(t.formBody,[s,o,n]),v(t.cardBody,""),l(t.cardBody,t.formBody),y(t.formBody,"submit",a=>D.formSubmitted(t,a,i)),D.createAllFields(e==null?void 0:e.form_fields)},createAllFields(i){const t=p("#dynamicFields");i==null||i.forEach(e=>{D.createTextField(e,t)})},createTextField(i,t){const e=c("input"),s=i.field_type,o=s.includes("_")?s.split("_")[1]:s;W(e,"name",`${o}`),W(e,"placeholder",i.label+(i.required?"":" (optional)")),i.required&&W(e,"required",""),b(e,"formControl"),W(e,"type",s),l(t,e)},formSubmitted(i,t,e){return x(this,null,function*(){t.preventDefault();const s=t.target.querySelector('[type="submit"]'),o=s.textContent,n=new FormData(t.target);try{w(s,"Sending..."),b(s,"disabled");const r=yield fetch(`${i.apiEndPoint}/responses`,{method:"POST",body:n}).then(a=>a.json());(r==null?void 0:r.status)==="success"?D.formSubmittedData(i,n,e):yield D.showToast(i,"error",r==null?void 0:r.data,e),t.target.reset(),z(t.target,".cfit-title").forEach(a=>{w(a,"No file chosen")}),S(s,"disabled"),w(s,o)}catch(r){console.log(r),yield D.showToast(i,"error"),S(s,"disabled"),w(s,o)}})},formSubmittedData(i,t,e,s=1){return x(this,null,function*(){t.set("page",s);const o=yield fetch(`${i.apiEndPoint}/orderDetails`,{method:"POST",body:t}).then(n=>n.json());o.status==="success"&&(yield D.showToast(i,"success",o==null?void 0:o.data,e,t))})},showToast(i,t,e,s,o){return x(this,null,function*(){var u,m;if((e==null?void 0:e.status_code)===200){D.orderDetailsItems(i,e,s),(((u=e==null?void 0:e.pagination)==null?void 0:u.has_next)||((m=e==null?void 0:e.pagination)==null?void 0:m.has_previous))&&D.renderOrderDetailsPagination(i,e==null?void 0:e.pagination,o,s);return}const n=c("div",{class:`toast ${t}`}),r=c("div",{class:"toast-content"}),a=c("div",{class:"toast-text"}),d=c("div",{class:"toast-text-body"});d.textContent=t==="success"?e==null?void 0:e.message:"Something went wrong",l(a,[d]),l(r,a),l(n,r),l(i.cardBody,n),b(i.formBody,"hide"),yield i.delay(10),I(i.formBody,"hide")&&(i.cardBody.removeChild(n),S(i.formBody,"hide"))})},orderDetailsItems(i,t,e){var f;const s=c("div",{id:"orderDetailsBody"}),o=c("div",{id:"listWrapper"}),n=c("div",{id:"lists"});l(o,n);const r=c("div",{id:"orderDetailsDescription"}),a=c("div",{class:"descriptionTitle"}),d=c("button",{class:"iconBtn closeDescBtn",title:"Back"});v(d,tt);const u=c("p");l(a,[d,u]);const m=c("div",{class:"content"});l(r,[a,m]),l(s,[o,r]),v(i.cardBody,""),l(i.cardBody,s);const g=(f=e==null?void 0:e.config)==null?void 0:f.order_details;if(t.items.length===1){D.singleItemContentShow(i,g,t);return}y(d,"click",B=>D.orderDetailsDescToggle(i,B)),D.renderWooCommerceItem(i,t,g)},singleItemContentShow(i,t,e){const s=e.items[0],o=p("#orderDetailsBody");o.removeChild(p("#listWrapper")),o.removeChild(p("#orderDetailsDescription"));const n=c("div",{id:"singleItemContent"}),r=c("p",{class:"descriptionTitle title"});v(r,s.order_id?`Order Id: ${s.order_id} (${s.shipping_status})`:"");const a=c("div",{class:"content"});l(n,[r,a]),l(o,n),D.showContent(t,s),i.resetClientWidgetSize()},renderWooCommerceItem(i,t,e){i.itemListAppend(t.items),z(document,".listItemTitleWrapper").forEach(s=>{y(s,"click",o=>{D.orderDetailsDescToggle(i,o,t,e)})}),i.resetClientWidgetSize()},orderDetailsDescToggle(i,t,e,s){if(e){const r=e.items.find(a=>Number(a.order_id)===Number(t.target.closest(".listItemTitleWrapper").dataset.item_id));v(p(".descriptionTitle p"),`Order Id: ${r==null?void 0:r.order_id}`||""),D.showContent(s,r)}const o=p("#orderDetailsBody");if(q(p("#orderDetailsBody"),"openDesc")){const r=p("#orderDetailsDescription").scrollHeight;Object.assign(o.style,{height:r>400?"400px":`${r}px`,overflow:r>400?"auto":"initial"})}else o.removeAttribute("style");q(p("#listWrapper"),"hide"),i.resetClientWidgetSize()},showContent(i,t){let e="";i==null||i.filter(Boolean).forEach(s=>{const o=s.split("_").map(r=>r.charAt(0).toUpperCase()+r.slice(1).toLowerCase()).join(" ");let n=t[s];typeof n=="string"&&(n=n.split("-").map(r=>r.charAt(0).toUpperCase()+r.slice(1).toLowerCase()).join(" ")),e+=`${o}: ${n}<br>`}),v(p(".content"),e),p(".content").style.fontSize="1rem",p(".content").style.lineHeight="2"},renderOrderDetailsPagination(i,t,e,s){const o=c("div",{class:"pagination"}),n=c("span",{class:"pageNumber"});w(n,`${t==null?void 0:t.current} / ${t==null?void 0:t.total} page`);const r=c("button",{class:"nextPage"});w(r,"Next"),t!=null&&t.has_next||W(r,"disabled","");const a=c("button",{class:"prevPage"});w(a,"Prev"),t!=null&&t.has_previous||W(a,"disabled",""),y(r,"click",()=>D.formSubmittedData(i,e,s,t==null?void 0:t.next)),y(a,"click",()=>D.formSubmittedData(i,e,s,t==null?void 0:t.previous)),l(o,[a,r,n]),l(p("#lists"),o),i.resetClientWidgetSize()}},Z={wp_post_types:void 0,renderWPSearch(i){this.hideChannels(),this.renderCard(),this.setCardStyle(i),Z.wp_post_types=i==null?void 0:i.wp_post_types;const t=c("div",{id:"wpSearchBody"}),e=c("div",{id:"listWrapper"}),s=c("div",{id:"lists","data-link_open_action":i.open_window_action}),o=c("input",{type:"text",id:"listSearch",class:"formControl",placeholder:"Search"});l(e,[s,o]),l(t,e),v(this.cardBody,""),l(this.cardBody,t),this.searchPostPage(""),y(o,"input",this.debounce(n=>this.searchPostPage(n.target.value),600))},showLoading(i=!0){const t=p("#lists");if(t){const e=c("div",{class:"loading-container"}),s=c("div",{class:"loading-spinner"});if(i){const o=c("p",{class:"loading-text"});w(o,"Searching..."),l(e,[s,o])}else l(e,s);v(t,""),l(t,e)}},hideLoading(){const i=p(".loading-container");i&&i.remove()},searchPostPage(i,t=1,e=!1){return x(this,null,function*(){this.showLoading(!e),this.resetClientWidgetSize();try{const{data:s,pagination:o}=yield this.fetchWPSearchData(i,t);this.renderWPSearchItem(s),((o==null?void 0:o.has_next)||(o==null?void 0:o.has_previous))&&this.renderWPSearchPagination(o)}catch(s){console.error("Search error:",s);const o=p("#lists");o&&v(o,'<div class="error-message">Failed to load search results. Please try again.</div>')}finally{this.hideLoading(),this.resetClientWidgetSize()}})},fetchWPSearchData(i,t){return x(this,null,function*(){const{data:e}=yield fetch(`${this.apiEndPoint}/wpSearch`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({search:i,page:t,postTypes:Z.wp_post_types})}).then(s=>s.json());return e})},renderWPSearchItem(i){const t=p("#lists");v(t,"");const e=[];if(!i||i.length===0){const s=c("div",{class:"no-results"});w(s,"No results found"),l(t,s);return}i==null||i.forEach(s=>{const o=c("div",{class:"listItem"}),n=c("button",{class:"listItemTitleWrapper",title:s.post_link}),r=c("p",{class:"title"}),a=c("p",{class:"type"});l(o,n),l(n,[r,a]),w(r,(s==null?void 0:s.post_title)||"(no title)"),w(a,(s==null?void 0:s.post_type)||""),e.push(o),y(n,"click",()=>{const{link_open_action:d}=t.dataset;d==="new_window"?window.open(s.post_link,"_blank","popup"):window.open(s.post_link,d)})}),l(t,e)},renderWPSearchPagination(i){var r;const t=c("div",{class:"pagination"}),e=c("span",{class:"pageNumber"});w(e,`${i==null?void 0:i.current} / ${i==null?void 0:i.total} page`);const s=c("button",{class:"nextPage"});w(s,"Next"),i!=null&&i.has_next||W(s,"disabled","");const o=c("button",{class:"prevPage"});w(o,"Prev"),i!=null&&i.has_previous||W(o,"disabled","");const n=((r=p("#listSearch"))==null?void 0:r.value)||"";y(s,"click",()=>this.searchPostPage(n,i==null?void 0:i.next,!0)),y(o,"click",()=>this.searchPostPage(n,i==null?void 0:i.previous,!0)),l(t,[o,s,e]),l(p("#lists"),t)}};var N,E,M,j,J;class pt{constructor(t){h(this,"apiEndPoint");h(this,"root");h(this,"widgetData");h(this,"clientDomain");h(this,"widgetBubble");h(this,"widgetBubbleWrapper");h(this,"contentWrapper");h(this,"widgetWrapper");h(this,"channels");U(this,N,void 0);U(this,E,void 0);U(this,M,void 0);h(this,"callToAction");h(this,"closeCallToAction");U(this,j,void 0);h(this,"card");h(this,"selectedFormBg");h(this,"cardBody");h(this,"formBody");U(this,J,void 0);h(this,"iFrameWrapper");h(this,"animationName");h(this,"formData");h(this,"clickTrack");h(this,"delay",t=>new Promise(e=>setTimeout(e,t*1e3)));h(this,"addEvents",()=>{y(window,"message",this.onMessageReceived),y(this.widgetBubble,"click",this.onBubbleClick)});h(this,"closeWidget",()=>{this.hideCard(),this.hideChannels(),typeof this.iFrameWrapper<"u"&&this.removeIframe(),S(this.widgetBubble,"open"),b(this.contentWrapper,"hide"),this.widgetOpenActions(!1),_(this.root.style,"--card-width","330px"),this.showActiveBadge(),this.enableAnimation()});h(this,"widgetClickRequest",()=>x(this,null,function*(){if(I(this.channels,"show")&&!this.clickTrack.isWidgetClicked){this.clickTrack.isWidgetClicked=!0;try{fetch(`${this.apiEndPoint}/analyticsStore`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({widget_id:this.widgetData.id,is_clicked:1})})}catch(t){console.log(t)}}}));h(this,"onBubbleClick",(t,e=!1)=>{var s,o,n;if(!(e&&I(this.widgetBubble,"open"))){if(((o=(s=this.widgetData)==null?void 0:s.styles)==null?void 0:o.widget_style)==="widget_box"&&b(this.contentWrapper,"widget-box"),q(this.channels,"show"),((n=this.widgetData)==null?void 0:n.isAnalyticsActivate)===1&&this.widgetClickRequest(),I(this.card,"show"))_(this.root.style,"--card-width","330px"),this.hideCard(),this.resetClientWidgetSize();else if(typeof this.iFrameWrapper<"u")this.removeIframe();else{q(this.contentWrapper,"hide");const r=q(this.widgetBubble,"open");this.widgetOpenActions(r)}I(this.contentWrapper,"hide")?(this.showActiveBadge(),this.enableAnimation()):(this.hideActiveBadge(),this.disableAnimation())}});h(this,"widgetOpenActions",t=>{if(this.openClientWidget(t),t&&!I(this.callToAction,"hide")){this.callToActionHide();return}this.resetClientWidgetSize()});h(this,"callToActionHide",()=>{b(this.callToAction,"hide"),b(this.closeCallToAction,"hide"),this.resetClientWidgetSize()});h(this,"channelClickRequest",t=>x(this,null,function*(){if(t!==void 0&&!Object.hasOwn(this.clickTrack,t)){this.clickTrack[t]=!0;try{fetch(`${this.apiEndPoint}/analyticsStore`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({widget_id:this.widgetData.id,channel_id:t,is_clicked:1})})}catch(e){console.log(e)}}}));h(this,"onChannelClick",t=>{var g,f,B,C,k,A,O,L;t.preventDefault();let e=t.target.closest(".channel");((f=(g=this.widgetData)==null?void 0:g.styles)==null?void 0:f.widget_style)==="widget_box"&&(e=t.target.closest(".channel-widget-box"));const{id:s,url:o,channel_name:n,target:r}=e.dataset||{},a=(B=this.widgetData)==null?void 0:B.widget_channels.find(R=>R.id===s),{title:d,unique_id:u}=(a==null?void 0:a.config)||{},{isChatWidget:m}=((C=a==null?void 0:a.config)==null?void 0:C.card_config)||{};((k=this.widgetData)==null?void 0:k.isAnalyticsActivate)===1&&this.channelClickRequest(s),n==="faq"?this.renderFaq(a):n==="wechat"?this.renderWeChat(a):n==="custom-form"?this.renderForm(a):n==="woocommerce"?this.renderWooCommerce(a):n==="knowledge-base"?this.renderKnowledgeBase(a):n==="wp-search"?this.renderWPSearch(a==null?void 0:a.config):n==="google-map"?this.renderIframe(o,n,u):n==="youtube"||n==="custom-iframe"?this.renderIframe(o,n,!1,(A=a==null?void 0:a.config)==null?void 0:A.iframe_options):m?this.chatWidgetClick(n):r==="new_window"&&o!=="#"?window.open(o,"_blank","popup"):o!=="#"&&window.open(o,r),this.resetClientWidgetSize(),((L=(O=this.widgetData)==null?void 0:O.styles)==null?void 0:L.google_analytics)===1&&this.channelClickEventTrigger(n,d,o)});h(this,"getClientInfo",()=>{H(parent,{action:"getClientInfo"},`${this.clientDomain}`)});h(this,"openClientWidget",t=>{H(parent,{action:"widgetOpen",isWidgetOpen:t},`${this.clientDomain}`)});h(this,"removeClientWidget",()=>{H(parent,{action:"removeWidget"},`${this.clientDomain}`)});h(this,"renderWidgetConf",()=>{var t,e,s,o,n,r,a,d,u,m,g,f,B,C,k;H(parent,{action:"widgetLoaded",height:(((e=(t=this.widgetData)==null?void 0:t.styles)==null?void 0:e.size)||60)+20,width:(((o=(s=this.widgetData)==null?void 0:s.styles)==null?void 0:o.size)||60)+20,position:(r=(n=this.widgetData)==null?void 0:n.styles)==null?void 0:r.position,top:((d=(a=this.widgetData)==null?void 0:a.styles)==null?void 0:d.top)||0,bottom:((m=(u=this.widgetData)==null?void 0:u.styles)==null?void 0:m.bottom)||0,left:((f=(g=this.widgetData)==null?void 0:g.styles)==null?void 0:f.left)||0,right:((C=(B=this.widgetData)==null?void 0:B.styles)==null?void 0:C.right)||0,pageScroll:(k=this.widgetData)==null?void 0:k.page_scroll},`${this.clientDomain}`)});h(this,"chatWidgetClick",t=>{H(parent,{action:"chatWidgetClick",chatWidgetName:t},`${this.clientDomain}`)});h(this,"channelClickEventTrigger",(t,e,s)=>{H(parent,{action:"bitAssistChannelClick",channelInfo:{channelType:t,channelName:e,channelUrl:s}},`${this.clientDomain}`)});h(this,"onMessageReceived",t=>{const{action:e}=t.data;e==="windowLoaded"?this.handleWindowLoaded(t.data):e==="scrollPercent"?this.handleScrollPercent(t.data):e==="clickOutside"&&this.closeWidget()});h(this,"handleWindowLoaded",({url:t,winWidth:e,winHeight:s,scrollPercent:o,apiEndPoint:n})=>{_(this.root.style,"--client-win-width",`${e}px`),_(this.root.style,"--client-win-height",`${s}px`),$(this,M,o),this.apiEndPoint=n,$(this,N,e<768),$(this,E,t.slice(this.clientDomain.length+1,t.length)),this.fetchWidgetData()});h(this,"handleScrollPercent",({scrollPercent:t})=>{var e;$(this,M,t),((e=this.widgetData)==null?void 0:e.page_scroll)>0&&!T(this,J)&&this.widgetShowAfterScroll()});h(this,"fetchWidgetData",()=>x(this,null,function*(){try{const{data:t}=yield fetch(`${this.apiEndPoint}/bitAssistWidget`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({domain:this.clientDomain})}).then(e=>e.json());if(this.widgetData=t,typeof this.widgetData.id>"u"){console.error(this.widgetData),this.removeClientWidget();return}this.widgetSetup()}catch(t){console.log(t),this.removeClientWidget()}}));h(this,"widgetSetup",()=>x(this,null,function*(){var e,s,o,n,r,a,d,u,m,g,f,B,C,k,A,O,L;const t=(s=(e=this.widgetData)==null?void 0:e.styles)==null?void 0:s.widget_show_on;t!==void 0&&(t.length===0||T(this,N)&&!t.includes("mobile")||!T(this,N)&&!t.includes("desktop"))||!this.setWidgetVisibleOrNot()||(this.renderWidgetConf(),!(((n=(o=this.widgetData)==null?void 0:o.business_hours)==null?void 0:n.length)&&!this.checkBusinessHours())&&(this.addCustomStyles(),this.renderChannels(),this.renderWidgetBubble(),this.hideCredit(),$(this,J,!0),yield this.widgetShowDelay(),this.delayExist=!1,this.showCallToAction(),this.widgetShowAfterScroll(),((a=(r=this.widgetData.styles)==null?void 0:r.position)==null?void 0:a.indexOf("top"))>-1&&_(this.root.style,"--widget-minus-sizeY",`${((d=this.widgetData.styles)==null?void 0:d.top)||0}px`),((m=(u=this.widgetData.styles)==null?void 0:u.position)==null?void 0:m.indexOf("bottom"))>-1&&_(this.root.style,"--widget-minus-sizeY",`${((g=this.widgetData.styles)==null?void 0:g.bottom)||0}px`),((B=(f=this.widgetData.styles)==null?void 0:f.position)==null?void 0:B.indexOf("left"))>-1&&_(this.root.style,"--widget-minus-sizeX",`${((C=this.widgetData.styles)==null?void 0:C.left)||0}px`),((A=(k=this.widgetData.styles)==null?void 0:k.position)==null?void 0:A.indexOf("right"))>-1&&_(this.root.style,"--widget-minus-sizeX",`${((O=this.widgetData.styles)==null?void 0:O.right)||0}px`),((L=this.widgetData)==null?void 0:L.isAnalyticsActivate)&&this.widgetData.id!=="undefined"&&this.widgetData.widget_channels.length!==0&&fetch(`${this.apiEndPoint}/analyticsStore`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({widget_id:this.widgetData.id})})))}));h(this,"hideCredit",()=>{var t,e;(t=this.widgetData)!=null&&t.hide_credit&&((e=p("#credit"))==null||e.remove())});h(this,"setWidgetVisibleOrNot",()=>{var t,e,s;if(((e=(t=this.widgetData)==null?void 0:t.exclude_pages)==null?void 0:e.length)>0){let o=!1,n=!1;const r=(s=this.widgetData)==null?void 0:s.exclude_pages.some(a=>(a.visibility==="showOn"&&(o=!0),a.condition==="contains"&&T(this,E).includes(a.url)||a.condition==="equal"&&T(this,E)===a.url||a.condition==="startWith"&&T(this,E).startsWith(a.url)||a.condition==="endWith"&&T(this,E).endsWith(a.url)?a.visibility==="hideOn"?!0:(n=!0,!1):!1));if(o&&!r&&!n||!o&&r&&!n)return this.removeClientWidget(),!1}return!0});h(this,"checkBusinessHours",()=>{var g,f;const t=new Date,e=(g=this.widgetData)==null?void 0:g.business_hours[t.getDay()];if(!e||!(e!=null&&e.start)||!(e!=null&&e.end))return this.removeClientWidget(),!1;const[s,o]=(e==null?void 0:e.start.split(":").map(Number))||[0,0],[n,r]=(e==null?void 0:e.end.split(":").map(Number))||[0,0],a=((f=this.widgetData)==null?void 0:f.timezone)||Intl.DateTimeFormat().resolvedOptions().timeZone,d=t.toLocaleTimeString("en-US",{timeZone:a,hour12:!1}),[u,m]=d.split(":").map(Number);return(u<s||u===s&&m<o||u>n||u===n&&m>r)&&$(this,j,!1),!0});h(this,"addCustomStyles",()=>{var t;if(((t=this.widgetData.custom_css)==null?void 0:t.length)>0){const e=c("style");l(e,document.createTextNode(this.widgetData.custom_css)),l(document.head,e)}});h(this,"renderChannels",()=>{var s,o,n,r;const t=(o=(s=this.widgetData)==null?void 0:s.styles)==null?void 0:o.widget_style;this.channels=c("div",{id:"channels"}),t==="widget_box"&&b(this.channels,"channel-padding");const e=(r=(n=this.widgetData)==null?void 0:n.widget_channels)==null?void 0:r.filter(a=>{var d,u,m;return(T(this,N)&&((d=a.config)==null?void 0:d.channel_show_on.includes("mobile"))||!T(this,N)&&((u=a.config)==null?void 0:u.channel_show_on.includes("desktop")))&&(!T(this,j)&&!((m=a.config)!=null&&m.hide_after_office_hours)||T(this,j))}).map(a=>{var f;const d=c("button",{class:t==="widget_box"?"channel-widget-box":"channel","data-id":a.id,"data-channel_name":a.channel_name.toLowerCase(),"data-url":((f=a.config)==null?void 0:f.url)||"#","data-target":a.config.open_window_action}),u=c("div",{class:"channel-name"});w(u,a.config.title);const m=c("div",{class:"channel-icon"}),g=c("img",{src:a.channel_icon,alt:a.config.title});return l(m,g),l(d,[u,m]),d});l(this.channels,e),l(this.contentWrapper,this.channels),t==="widget_box"&&b(this.contentWrapper,"widget-box"),z(document,t==="widget_box"?".channel-widget-box":".channel").forEach(a=>{y(a,"click",this.onChannelClick)})});h(this,"renderWidgetBubble",()=>{var e,s,o,n,r,a,d,u,m,g,f,B,C,k,A,O,L,R,et,it,st,ot,nt,rt,ct,at;_(this.root.style,"--widget-size",`${((s=(e=this.widgetData)==null?void 0:e.styles)==null?void 0:s.size)||60}px`),_(this.root.style,"--widget-color",(r=(n=(o=this.widgetData)==null?void 0:o.styles)==null?void 0:n.color)==null?void 0:r.str),((a=this.widgetData)==null?void 0:a.widget_behavior)===2?y(this.widgetBubble,"mouseenter",ut=>this.onBubbleClick(ut,!0)):((d=this.widgetData)==null?void 0:d.widget_behavior)===3&&this.onBubbleClick(),b(this.widgetBubble,(m=(u=this.widgetData)==null?void 0:u.styles)==null?void 0:m.shape),b(this.widgetWrapper,(f=(g=this.widgetData)==null?void 0:g.styles)==null?void 0:f.position),p("#widget-img").src=((C=(B=this.widgetData)==null?void 0:B.styles)==null?void 0:C.customImage)||((A=(k=this.widgetData)==null?void 0:k.styles)==null?void 0:A.iconUrl),b(p("#widget-img"),(L=(O=this.widgetData)==null?void 0:O.styles)!=null&&L.customImage?"image":"icon");const t=Math.round((Number.parseInt((it=(et=(R=this.widgetData)==null?void 0:R.styles)==null?void 0:et.color)==null?void 0:it.r,10)*299+Number.parseInt((nt=(ot=(st=this.widgetData)==null?void 0:st.styles)==null?void 0:ot.color)==null?void 0:nt.g,10)*587+Number.parseInt((at=(ct=(rt=this.widgetData)==null?void 0:rt.styles)==null?void 0:ct.color)==null?void 0:at.b,10)*114)/1e3);_(this.root.style,"--widget-bubble-icon-color",t>125?"invert(0)":"invert(1)"),this.showActiveBadge(),this.enableAnimation(),I(this.channels,"show")&&(this.hideActiveBadge(),this.disableAnimation())});h(this,"showActiveBadge",()=>{var e,s,o,n,r,a,d;const t=(s=(e=this.widgetData)==null?void 0:e.styles)==null?void 0:s.shape;((n=(o=this.widgetData)==null?void 0:o.styles)==null?void 0:n.badge_active)===0?S(this.widgetBubbleWrapper,`active-${t}`):(b(this.widgetBubbleWrapper,`active-${t}`),_(this.root.style,"--widget-active-badge-color",(d=(a=(r=this.widgetData)==null?void 0:r.styles)==null?void 0:a.badge_color)==null?void 0:d.str)),this.resetClientWidgetSize()});h(this,"hideActiveBadge",()=>{var t,e;S(this.widgetBubbleWrapper,`active-${(e=(t=this.widgetData)==null?void 0:t.styles)==null?void 0:e.shape}`)});h(this,"enableAnimation",()=>{var e,s,o,n,r,a,d;const t=(s=(e=this.widgetData)==null?void 0:e.styles)==null?void 0:s.animation_type;((n=(o=this.widgetData)==null?void 0:o.styles)==null?void 0:n.animation_active)===1&&(_(this.root.style,"--animation-delay",`${(d=(a=(r=this.widgetData)==null?void 0:r.styles)==null?void 0:a.animation_delay)==null?void 0:d.delay}s`),t===1?(this.animationName="--wiggle-animation",b(this.widgetBubbleWrapper,this.animationName)):t===2?(this.animationName="--jump-animation",b(this.widgetBubbleWrapper,this.animationName)):t===3&&(this.animationName="--shockwave-animation",b(this.widgetBubbleWrapper,this.animationName))),this.resetClientWidgetSize()});h(this,"disableAnimation",()=>{S(this.widgetBubbleWrapper,this.animationName)});h(this,"widgetShowDelay",()=>x(this,null,function*(){var t;((t=this.widgetData)==null?void 0:t.initial_delay)>0&&(yield this.delay(this.widgetData.initial_delay))}));h(this,"widgetShowAfterScroll",()=>x(this,null,function*(){var t,e;((t=this.widgetData)==null?void 0:t.page_scroll)<=0||T(this,M)>=((e=this.widgetData)==null?void 0:e.page_scroll)?S(this.widgetWrapper,"hide"):b(this.widgetWrapper,"hide"),this.resetClientWidgetSize()}));h(this,"showCallToAction",()=>x(this,null,function*(){var e,s,o,n;if(!((s=(e=this.widgetData)==null?void 0:e.call_to_action)!=null&&s.text))return;((n=(o=this.widgetData)==null?void 0:o.call_to_action)==null?void 0:n.delay)>0&&(yield this.delay(this.widgetData.call_to_action.delay)),this.callToAction=c("div",{id:"callToActionMsg"}),v(this.callToAction,this.widgetData.call_to_action.text);const t=c("img",{src:G});if(this.closeCallToAction=c("button",{class:"iconBtn",id:"closeCallToAction"}),l(this.closeCallToAction,t),y(this.closeCallToAction,"click",this.callToActionHide),p("#widgetBubbleRow").prepend(this.closeCallToAction,this.callToAction),I(this.widgetBubble,"open")){this.callToActionHide();return}this.resetClientWidgetSize()}));this.clickTrack={isWidgetClicked:!1},$(this,J,!0),$(this,j,!0),$(this,N,!1),this.root=document.documentElement,this.clientDomain=t.clientDomain,this.contentWrapper=p("#contentWrapper"),this.widgetWrapper=p("#widgetWrapper"),this.widgetBubbleWrapper=p("#widgetBubbleWrapper"),this.widgetBubble=p("#widgetBubble"),this.addEvents(),this.getClientInfo()}}N=new WeakMap,E=new WeakMap,M=new WeakMap,j=new WeakMap,J=new WeakMap;Object.assign(pt.prototype,F(F(F(F(F(F(F(F({},P),yt),wt),V),Y),bt),D),Z));const vt=new URL(window.location.href),X=vt.searchParams.get("clientDomain"),K=X==null?void 0:X.split("-protocol-bit-assist-"),_t=(K==null?void 0:K[0])==="i"?"http://":"https://",Bt=K==null?void 0:K[1],Dt=_t+Bt;window.addEventListener("load",()=>{new pt({clientDomain:Dt})});
